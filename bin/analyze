#!/usr/bin/env node
(async () => {

  const App = require('commander')

  /**
   * Main Program
   */
  App.version()
    .option('-d, --dir', 'Directory of NC files to analyze')
    .parse(process.argv);

  try {
    const files = new FileCollector({
      dir: App.dir,
      whitelist
    })

    files.getPrograms(programs => {
      let toolpathCount = _.sumBy(programs, program => {
        return program.toolpaths.length
      })

      console.log('')
      console.log(`Analyzed ${toolpathCount} toolpaths in ${programs.length} NC files.`)
    })
  } catch (err) {
    console.error(err)
  }

})()
